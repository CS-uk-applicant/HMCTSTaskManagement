@page
@model IndexModel
@{
    ViewData["Title"] = "Task Management System";
}

<h1>List of tasks</h1>
<table class="table">
    <thead>
        <tr> 
            <th> Title </th>
            <th> Description </th>
            <th> Status </th>
            <th> Due </th>
        </tr>
    </thead>
    <tbody>
        @foreach(var task in Model.tasks)
        {
            <tr>
                <td>@task.Title</td>
                <td>@task.Description</td>
                <td>@task.Status</td>
                <td>@task.DueDateTime</td>

                <td><a href="/ViewTask/@task.Id" class="btn btn-info btn-sm">View</a></td>

                <td><a href="/UpdateTask/@task.Id" class="btn btn-warning btn-sm">Update</a></td>

                <td>
                    @* asp-page-handler="Delete" tells the razor page to call the method 'OnPostDelete' (Delete matches the name) when the form is submitted*@
                    @* asp-route-id="@task.Id attaches task ID as a route parameter when submitting, so that OnPostDelete(int id) receives the correct ID*@
                    <form method="post" asp-page-handler="Delete" asp-route-id="@task.Id">
                        <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this task?');">Delete</button>
                    </form>
                </td>
            </tr>
        }

        <tr><td><a href="/CreateTask" class="btn btn-success mb-3">Create New Task</a></td></tr>
    </tbody>
</table>